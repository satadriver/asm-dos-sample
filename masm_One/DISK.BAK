.386
DATA SEGMENT  PARA USE16


DATA ENDS

CODE SEGMENT PARA USE16
ASSUME CS:CODE
START:
MOV AX,8000H
MOV DS,AX
XOR EAX,EAX
CALL READSECTOR
MOV SI,1BEH



MOV AH,4CH
INT 21H

READSECTOR PROC NEAR
PUSH EAX
PUSH ECX
PUSH EDX
PUSH EDI
PUSH ES
MOV DX,173H
OUT DX,AL
INC DX
SHR EAX,8
OUT DX,AL
INC DX
SHR EAX,8
OUT DX,AL
INC DX
SHR EAX,8
ADD AL,0E0H
OUT DX,AL
MOV DX,172H
MOV AL,1
OUT DX,AL
MOV DX,177H
MOV AL,20H
OUT DX,AL
WAITFG:IN AL,DX
CMP AL,58H
JNZ WAITFG
MOV DX,170H
MOV CX,100H
MOV AX,8000H
MOV ES,AX
MOV DI,0
REP INSW
POP ES
POP EDI
POP EDX
POP ECX
POP EAX
RET
READSECTOR ENDP
CODE ENDS
END START

