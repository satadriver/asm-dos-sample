.286
.model small
.STACK 100H
.code
start:
MOV AX,@DATA
MOV DS,AX
MOV ES,AX
MOV DX,172H;read out MBR data to datasegment offset 400h 
MOV AL,1
OUT DX,AL
XOR AX,AX
INC DX
OUT DX,AL
INC DX
OUT DX,AL
INC DX
OUT DX,AL
INC DX
MOV AL,0E0H
OUT DX,AL
INC DX
MOV AL,20H
OUT DX,AL
L0:IN AL,DX
CMP AL,58H
JNZ L0
CLD
MOV DI,400H
PUSH DI
MOV DX,170H
MOV CX,100H
REP INSW

MOV DX,172H;WRITE MBR TO SECTOR 1
MOV AL,1
OUT DX,AL
INC DX
OUT DX,AL
MOV DX,177H
MOV AL,30H
OUT DX,AL
L1:IN AL,DX
CMP AL,58H
JNZ L1
POP SI
MOV CX,100H
MOV DX,170H
REP OUTSW

MOV DX,172H;WRITE MAINPRO TO SECTOR 0
MOV AL,1
OUT DX,AL
INC DX
XOR AX,AX
OUT DX,AL
MOV DX,177H
MOV AL,30H
OUT DX,AL
LL0:IN AL,DX
CMP AL,58H
JNZ LL0

MOV SI,OFFSET MAINPROC
MOV DI,OFFSET STR0
SUB DI,SI
MOV AX,DI
MOV BX,2
DIV BX
MOV CX,AX
MOV AX,DS
PUSH AX
MOV AX,CS
MOV DS,AX
MOV DX,170H
REP  INSW
POP AX
MOV DS,AX

MAINPROC:

MOV AX,0B800H
MOV ES,AX
MOV SI,OFFSET STR0
MOV DI,OFFSET STR2
SUB DI ,SI
MOV  CX,DI
MOV BL,12H
mov si,0
mov di,0
L2:MOV AL,DS:[SI]
MOV ES:[DI],AL
INC DI
MOV ES:[DI],BL
INC SI
INC DI
LOOP L2
MOV AH,0
INT 16H
CMP AL,62H
JNZ NEXT
JMP BEGIN
NEXT:CMP AL,42H
JNZ RESET
BEGIN:
PUSH SI
PUSH DI
MOV SI,OFFSET STR2
MOV DI,OFFSET STR3
SUB DI ,SI
MOV  CX,DI
POP DI
POP SI
MOV BL,41H
L3:MOV AL,DS:[SI]
MOV ES:[DI],AL
INC DI
MOV ES:[DI],BL
INC SI
INC DI
LOOP L3
MOV AH,0
INT 16H

MOV DX,172H
MOV AL,1
OUT DX,AL
INC DX
OUT DX,AL
MOV DX,177H
MOV AL,20H
OUT DX,AL
L4:IN AL,DX
CMP AL,58H
JNZ L4
MOV DI,7C00H
MOV DX,170H
MOV CX,100H
REP INSW
MOV AX,0
MOV DS,AX
JMP DWORD PTR DS:[7C00H]

RESET:
PUSH SI
PUSH DI
MOV SI,OFFSET STR3
MOV DI,OFFSET STR4
SUB DI ,SI
MOV  CX,DI
MOV BL,23H

pop di
Pop si

L5:MOV AL,DS:[SI]
MOV ES:[DI],AL
INC DI
MOV ES:[DI],BL
INC SI
INC DI
LOOP L5
MOV AH,0
INT 16H
MOV AX,0FFFFH
MOV DS,AX
JMP DWORD  PTR DS:[0]
MOV AH,0
INT 16H
INT 19H
NOP
NOP
NOP
NOP

.DATA
STR0 DB "BEFORE STRAT THIS MY COMPUTER,I HAVE A LITTLE QUESTION :",0AH,0DH
STR1 DB  "WHAT IS THE COLOR OF THE SKY?CHOOSE B IF IT IS BLUE,ELSE CHOOSE A ",0AH,0DH
STR2 DB "OK,U ARE RIGHT,U PASSED"
STR3 DB "WRONG ANSWER!U FAILES,GETOUT"
STR4 DB ?
END START







