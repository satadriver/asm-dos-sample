public music

data1 segment

;---------------³¬¼¶ÂêÀö -------------------------

mus_freg     dw 659,659,659,523,659,20000,784,20000,392
dw 20000,523,20000,392,20000,330,20000,440
dw 494,494,440,392,659,784,880,20000,698,784
dw 20000,659,20000,523,587,494,20000,523,20000,392,20000
dw 20000,330,20000,440,494,20000,494,440,20000,392,659
dw 784,880,698,784,20000,659,587,523,494
dw 20000,784,698,698,659,659,392,440,523,20000
dw 440,523,587,20000,784,698,698,659,20000,659,1046
dw 1046,1046,20000,20000,784,698,698,659,659
dw 20000, 392,20000,440,523,440,523,20000,587,20000,659,20000
dw 587,20000,523,20000,20000,20000,784
dw 20000,698,698,659,20000,659,20000,392,440,523,20000,440,523,587
dw 20000,784,698,698,659,20000,659,20000,523,20000,523,523
dw 20000,20000,784,698,698,659,20000,659, 392,440
dw 20000,523,20000,880,523,587,20000,20000,659,20000,20000,587,20000
dw 523,20000,20000,20000,523,523,20000
dw 523,587,20000,659,20000,523,20000,880,784,20000,523,523
dw 20000,523,20000,523,587,659,20000
dw 523,523,20000,523,523,587,20000,659,523,20000,440,392
dw 20000,659,659,20000,659,20000,523,659,20000,784,20000
dw 20000,392,20000,523,20000,392,20000,330
dw 20000,440,494,494,440,392,659,698,20000,880
dw 20000,698,784,20000,659,20000,523,587,494,20000,523,20000
dw 20000,392,20000,330,20000,394,20000,330
dw 20000,440,494,494,449,392,659,698,20000,880
dw 20000,698,784,20000,659,20000,523,587,494,20000,523,20000
dw 20000,784,20000,330,440,494,20000,494,440
dw 392,659,784,880,20000,698,784,20000,659,20000,523,587
dw 494,20000,659,523,20000,392,392,440,698
dw 20000,698,440,20000,494,880,880,880,784,20000,698
dw 659,523,440,392,20000,20000,659,523,20000,392
dw 20000,392,440,698,20000,698,440,20000,494,698
dw 20000,698,698,659,587,20000,523,330,20000,330,262,20000,-1




  

mus_time    dw 20,20,20,10,10,6,20,6,20
dw 6,10,6,10,6,10,6,20
dw 20,10,20,20,20,20,10,10,6,10,10
dw 6,10,6,10,10,20,6,10,6,10,6
dw 6,10,6,20,10,6,10,20,6,10,20
dw 20,20,20,20,6,20,10,10,40
dw 6,20,10,10,20,20,10,20,20,6
dw 10,10,20,6,10,10,20,20,6,20,20
dw 20,20,6,6,10,10,10,20,10
dw 6,10,10,20,10,10,6,10,6,10,6
dw 20,6,10,6,6,6,10
dw 6,10,10,10,6,10,6,10,10,20,6,10,10,10
dw 6,10,10,10,20,6,10,6,10,6,20,20
dw 6,6,10,10,10,10,6,20,10,10
dw 6,10,6,10,10,10,6,6,10,6,6,10,6
dw 20,6,6,6,10,10,6,10,6
dw 10,10,6,10,6,10,6,10,40,6,10,20
dw 6,10,6,10,10,10,6
dw 10,10,6,20,10,10,6,10,10,6,20,20
dw 6,10,10,6,10,6,10,10,6,6,6 ;aaaaaaaaaaaaaaaaaaaaaaaaaaaa
dw 6,20,6,20,6,20,6,20
dw 6,20,20,20,20,20,10,10,6,10
dw 6,10,20,6,10,6,10,20,20,6,10,6
dw 6,10,6,40,20,20,6,10,20
dw 20,20,10,10,6,10,10,6,10,6,10,10
dw 20,6,10,10,6,10,10,10,20
dw 6,10,20,6,10,20,20,10,20,6,40
dw 20,20,20,20,6,6,10,10,6,20
dw 6,10,10,10,6,10,40,6,10,20
dw 6,10,20,10,10,6,10,20,6,10,20,6



            
            
data1    ends

sta1     segment stack

         db    64 dup(0)

sta1     ends

code1    segment

         assume cs: code1, ds: data1, ss: sta1

 

music    proc  far

         push  ds

         sub   ax, ax

         push  ax

  

         mov   ax, data1

         mov   ds, ax

  

         lea   si, mus_freg

         lea   bp, ds:mus_time

  

freq:

         mov   di, [si]

         cmp   di, -1

         je end_mus

         mov   bx, ds:[bp]

         call  soundf

         add   si, 2

         add   bp, 2

         jmp   freq

  

end_mus: ret

music    endp

 

soundf    proc  near

         push  ax

         push  bx

         push  cx

         push  dx

         push  di

         mov   al, 0b6h

         out   43h, al

         mov   dx, 12h

         mov   ax, 348ch

         div   di

         out   42h, al

         mov   al, ah

         out   42h, al

         in al, 61h

         mov   ah, al

         or al, 3

         out   61h, al

         ;mov bx, 3

wait1:    mov   cx, 5304

         call  waitf

delay:    loop  delay

         dec   bx

         jnz   wait1

         mov   al, ah

         out   61h, al

         pop   di

         pop   dx

         pop   cx

         pop   bx

         pop   ax

         ret

soundf    endp

 

waitf    proc  near

         push  ax

waitf1:

         in al, 61h

         and   al, 10h

         cmp   al, ah

         je waitf1

         mov   ah, al

         loop  waitf1

         pop   ax

         ret

waitf    endp

code1    ends

         end      music   
