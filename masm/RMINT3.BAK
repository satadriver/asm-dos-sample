CODE SEGMENT PARA
ASSUME CS:CODE
START:
PUSH DS
MOV AX,0
PUSH AX

MOV ES,AX
MOV DI,0CH
MOV AX,0
STOSW

MOV AX,2100H
STOSW

MOV AX,CODE
MOV DS,AX
MOV AX,2100H
MOV ES,AX
MOV SI,OFFSET INT1PROC
MOV DI,0

MOV CX,INT1PROCLEN
REP MOVSB
RETF

INT1PROC:
JMP L1
int1message db "int3 occurred",0ah,0dh,24h
l1:
push ax
push dx
push es
push ds
mov ax,2100h
mov ds,ax
mov dx,3
mov ah,9
int 21h

POP DX     ;INT1 IS DEFULT,IRET INSTRUCTION WILL MAKE IP BACK AT INT1,IP=IP+2
           ;SO THE IP WILL PASS THE INT1 INSTRUCTION

PUSH DX

POP DS
POP ES
POP DX
POP AX
IRET
INT1PROCLEN=$-INT1PROC
CODE ENDS
END START

